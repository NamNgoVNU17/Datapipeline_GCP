[2025-07-15T10:26:22.724+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-07-15T10:26:22.758+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_exchange_rates_and_upload.fetch_exchange_rates scheduled__2025-07-14T00:00:00+00:00 [queued]>
[2025-07-15T10:26:22.778+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_exchange_rates_and_upload.fetch_exchange_rates scheduled__2025-07-14T00:00:00+00:00 [queued]>
[2025-07-15T10:26:22.779+0000] {taskinstance.py:2866} INFO - Starting attempt 2 of 2
[2025-07-15T10:26:22.807+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): fetch_exchange_rates> on 2025-07-14 00:00:00+00:00
[2025-07-15T10:26:22.822+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=144) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-07-15T10:26:22.824+0000] {standard_task_runner.py:72} INFO - Started process 146 to run task
[2025-07-15T10:26:22.825+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'fetch_exchange_rates_and_upload', 'fetch_exchange_rates', 'scheduled__2025-07-14T00:00:00+00:00', '--job-id', '6', '--raw', '--subdir', 'DAGS_FOLDER/fetch_and_upload.py', '--cfg-path', '/tmp/tmpsbzhz1fh']
[2025-07-15T10:26:22.827+0000] {standard_task_runner.py:105} INFO - Job 6: Subtask fetch_exchange_rates
[2025-07-15T10:26:22.904+0000] {task_command.py:467} INFO - Running <TaskInstance: fetch_exchange_rates_and_upload.fetch_exchange_rates scheduled__2025-07-14T00:00:00+00:00 [running]> on host 7742db002d02
[2025-07-15T10:26:23.072+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='nam' AIRFLOW_CTX_DAG_ID='fetch_exchange_rates_and_upload' AIRFLOW_CTX_TASK_ID='fetch_exchange_rates' AIRFLOW_CTX_EXECUTION_DATE='2025-07-14T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-07-14T00:00:00+00:00'
[2025-07-15T10:26:23.074+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2025-07-15T10:26:23.074+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2025-07-15T10:26:23.075+0000] {logging_mixin.py:190} INFO - Current task name:fetch_exchange_rates state:running start_date:2025-07-15 10:26:22.759151+00:00
[2025-07-15T10:26:23.075+0000] {logging_mixin.py:190} INFO - Dag name:fetch_exchange_rates_and_upload and current dag run status:running
[2025-07-15T10:26:23.075+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-07-15T10:26:23.076+0000] {fetch_exchange_rates.py:81} WARNING - Begin run Task 1
[2025-07-15T10:26:23.077+0000] {fetch_exchange_rates.py:85} INFO - Fetching exchange rates from 2015-01-01 to 2025-07-08
[2025-07-15T10:26:23.079+0000] {fetch_exchange_rates.py:97} INFO - Generated 11 date ranges for API requests
[2025-07-15T10:26:23.089+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2015-01-01 to 2015-12-31 (1/11)
[2025-07-15T10:26:23.090+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:23.090+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2015-01-01', 'end_date': '2015-12-31', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:24.836+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:24.881+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=False)
[2025-07-15T10:26:24.891+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2016-01-01 to 2016-12-30 (2/11)
[2025-07-15T10:26:24.892+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:24.892+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2016-01-01', 'end_date': '2016-12-30', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:26.627+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:26.649+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:26.660+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2016-12-31 to 2017-12-30 (3/11)
[2025-07-15T10:26:26.661+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:26.661+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2016-12-31', 'end_date': '2017-12-30', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:28.727+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:28.750+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:28.760+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2017-12-31 to 2018-12-30 (4/11)
[2025-07-15T10:26:28.761+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:28.761+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2017-12-31', 'end_date': '2018-12-30', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:30.332+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:30.358+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:30.369+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2018-12-31 to 2019-12-30 (5/11)
[2025-07-15T10:26:30.369+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:30.370+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2018-12-31', 'end_date': '2019-12-30', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:31.942+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:31.966+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:31.977+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2019-12-31 to 2020-12-29 (6/11)
[2025-07-15T10:26:31.978+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:31.978+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2019-12-31', 'end_date': '2020-12-29', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:33.965+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:33.986+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:33.999+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2020-12-30 to 2021-12-29 (7/11)
[2025-07-15T10:26:34.000+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:34.000+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2020-12-30', 'end_date': '2021-12-29', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:35.889+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:35.911+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:35.920+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2021-12-30 to 2022-12-29 (8/11)
[2025-07-15T10:26:35.921+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:35.921+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2021-12-30', 'end_date': '2022-12-29', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:38.147+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:38.170+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:38.180+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2022-12-30 to 2023-12-29 (9/11)
[2025-07-15T10:26:38.180+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:38.181+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2022-12-30', 'end_date': '2023-12-29', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:39.889+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:39.912+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:39.922+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2023-12-30 to 2024-12-28 (10/11)
[2025-07-15T10:26:39.923+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:39.923+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2023-12-30', 'end_date': '2024-12-28', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:41.936+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:41.958+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:41.965+0000] {fetch_exchange_rates.py:107} INFO - Fetching exchange rates for 2024-12-29 to 2025-07-08 (11/11)
[2025-07-15T10:26:41.965+0000] {fetch_exchange_rates.py:26} INFO - Requesting API: https://api.exchangerate.host/timeframe
[2025-07-15T10:26:41.965+0000] {fetch_exchange_rates.py:27} INFO - Request params: {'start_date': '2024-12-29', 'end_date': '2025-07-08', 'currencies': 'VND,CNY,JPY,KRW,EUR,INR,GBP,HKD,AUD', 'access_key': '7a75f3586d9ba851ae879467a58b5c64'}
[2025-07-15T10:26:43.253+0000] {fetch_exchange_rates.py:31} INFO - Response status code : 200
[2025-07-15T10:26:43.267+0000] {fetch_exchange_rates.py:65} INFO - Saved data to /opt/***/src/data/exchange_rates_2015_2025.csv (append=True)
[2025-07-15T10:26:43.268+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-07-15T10:26:43.285+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-07-15T10:26:43.285+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=fetch_exchange_rates_and_upload, task_id=fetch_exchange_rates, run_id=scheduled__2025-07-14T00:00:00+00:00, execution_date=20250714T000000, start_date=20250715T102622, end_date=20250715T102643
[2025-07-15T10:26:43.636+0000] {logging_mixin.py:190} INFO - Task instance in success state
[2025-07-15T10:26:43.637+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: running
[2025-07-15T10:26:43.637+0000] {logging_mixin.py:190} INFO - Dag name:fetch_exchange_rates_and_upload queued_at:2025-07-15 10:21:01.321588+00:00
[2025-07-15T10:26:43.638+0000] {logging_mixin.py:190} INFO - Task hostname:7742db002d02 operator:PythonOperator
[2025-07-15T10:26:43.666+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-07-15T10:26:43.705+0000] {taskinstance.py:3895} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-07-15T10:26:43.707+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
